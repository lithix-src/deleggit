# Catalyst Engineering Standards

> **Authority**: `orch:catalyst_gov`
> **Scope**: All Agents (Synthetic & Human)

## 1. Code Standards (The "Rigid Core")

### Backend (Go)
*   **Formatter**: `gofmt` (Strict).
*   **Linter**: `golangci-lint` (Enable: `errcheck`, `gosimple`, `staticcheck`).
*   **Architecture**:
    *   **Hexagonal**: `domain` -> `adapter`. No leakage.
    *   **Single Responsibility**: One Service, One Binary (`bin/service-name`).
*   **Error Handling**: Wrap errors. No `panic` in production code.

### Frontend (React/TS)
*   **Formatter**: `prettier` (Tab Width: 4, Double Quotes).
*   **Structure**: `src/features` for domain logic. `components/ui` for dumb primitives (Shadcn).
*   **State**: `zustand` or `React Context` for global state. Avoid prop drilling > 3 levels.
*   **Styling**: `Tailwind CSS`. No magic values; use `slate-*` tokens.

### Infrastructure (IaC)
*   **Docker**: Multistage builds. `distroless` or `scratch` final images where possible.
*   **Kubernetes**: Helm Charts preferred over raw manifests for complex services.

---

## 2. Documentation Standards (The "Knowledge Graph")

### README.md
Every service (`/bin/docker-watcher`, `/ui`) MUST have a `README.md`.
*   **Header**: Service Name & Responsibility.
*   **Usage**: How to run it (`go run ...`).
*   **Env Vars**: Configuration table.

### ADRs (Architecture Decision Records)
Significant changes (New Services, Database choices) require an ADR in `/docs/adr/`.
*   Format: `NNN-title.md` (e.g., `001-mqtt-event-bus.md`).
*   Sections: Context, Decision, Consequences.

---

## 3. Agent Protocol (The "Swarm Contract")

### Identity Tagging
Agents MUST sign their work when creating new files.
**Format**: `// Generated by <AgentID> (Role)`
**Example**:
```go
// Generated by spec:infra:01 (Infrastructure)
package main
```

### Commit Messages (Conventional Commits)
**Format**: `type(scope): subject`
*   `feat`: New feature
*   `fix`: Bug fix
*   `docs`: Documentation only
*   `infra`: DevOps/Config changes
*   `refactor`: Code change that neither fixes a bug nor adds a feature

**Examples**:
*   `feat(docker): implement start/stop event listener`
*   `infra(prom): add prometheus scrape config`
*   `docs(std): initial engineering standards`

---

## 4. Operational Hygiene
*   **The Check**: Always run `make check` (or equivalent) before pushing.
*   **The Clean**: `make clean` should reset the environment to a known state.
